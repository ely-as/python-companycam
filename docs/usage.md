# Usage

## Getting started - API

Generate an access token [in the CompanyCam app](https://app.companycam.com/access_tokens)
and create an `API` object using your access token:

```python
>>> import companycam
>>> api = companycam.API(token="YOUR_TOKEN_HERE")
```

### Managers

The `API` object contains managers which mimic the categories of REST API paths in the
[CompanyCam Core API](https://docs.companycam.com/reference). It also contains a
`client` for [advanced usage](#custom-api-requests).

```python
>>> api.
api.client   api.company  api.groups   api.photos   api.projects api.tags    api.users    api.webhooks
```

### Methods

Each manager contain methods which correspond to REST API paths in the
[CompanyCam Core API](https://docs.companycam.com/reference):

```
>>> api.projects.
api.projects.assign_user_to_project(   api.projects.list_assigned_users(
api.projects.client                    api.projects.list_collaborators(
api.projects.create(                   api.projects.list_comments(
api.projects.create_comment(           api.projects.list_documents(
api.projects.create_document(          api.projects.list_invitations(
api.projects.create_invitation(        api.projects.list_labels(
api.projects.create_labels(            api.projects.list_photos(
api.projects.create_photo(             api.projects.remove_user_from_project(
api.projects.delete(                   api.projects.restore(
api.projects.delete_label(             api.projects.retrieve(
api.projects.include                   api.projects.update(
api.projects.list(                     api.projects.update_notepad(
```

For example, to list projects:

```python
>>> api.projects.list()
[Project(id='12345678', ...)]
```

This package is fully typed. Arguments passed to manager methods can be type-checked.

### Working with models

All CompanyCam entities are adapted into models. They ensure that request data is correctly formatted and validated before being passed to the REST API. You can import the the `models` for ease of use:

```python
>>> from companycam.v2 import models
```

For example, to create a new project:
```python
>>> project = models.Project(name="My new project")
>>> api.projects.create(project)
Project(id='23456789', name='My new project', ...)
```

When creating or updating objects you should replace the original object with the
response e.g.:

```python
>>> project = api.projects.create(project)
```

This ensures that fields set by the server are updated locally e.g. `id`, `created_at`,
`updated_at` etc.

### Using strings in place of model objects

Certain API paths can accept a `str` in place of a model if that method only needs to identify a related object. For example, these two commands below are equivalent:

```python
>>> new_comment = models.Comment(content="My comment")
>>> api.projects.create_comment("23456789", new_comment)
>>> api.projects.create_comment(Project(id="23456789"), new_comment)
```

## Advanced

### Custom API requests

You can make authorized requests to the API directly using the HTTPX client generated by
the API object.

For example, to make a `GET` request to `/`:
```python
>>> with api.client.make_client() as client:
>>>     request = client.build_request("GET", "/")
>>>     response = client.send(request)
```

### Custom API endpoint

`companycam.API` objects can be instantiated with a custom endpoint (e.g. for testing):
```python
>>> api = companycam.API(
        token="YOUR_TOKEN_HERE",
        server_url="https://test.api.myserver.com"
    )
```
